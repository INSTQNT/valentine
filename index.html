<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>A question</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg1:#ffe0ea;
      --bg2:#cfefff;
      --bg3:#fff5cf;
      --card: rgba(255,255,255,.58);
      --card2: rgba(255,255,255,.30);
      --text:#222;
      --shadow: 0 22px 60px rgba(0,0,0,.18);
    }
    *{ box-sizing:border-box; }
    body{
      margin:0;
      min-height:100vh;
      display:grid;
      place-items:center;
      font-family: "Quicksand", system-ui, Arial;
      color:var(--text);
      overflow:hidden;
      background: radial-gradient(1200px 800px at 20% 20%, var(--bg1), transparent 60%),
                  radial-gradient(1100px 760px at 80% 30%, var(--bg2), transparent 60%),
                  radial-gradient(1000px 700px at 50% 85%, var(--bg3), transparent 60%),
                  linear-gradient(120deg, #fff1f6, #eafcff);
      animation: bgShift 12s ease-in-out infinite alternate;
    }
    @keyframes bgShift{
      from { filter: hue-rotate(0deg) saturate(1.02); }
      to   { filter: hue-rotate(10deg) saturate(1.08); }
    }
    .sparkles{
      position:fixed; inset:0;
      background-image:
        radial-gradient(circle at 10% 20%, rgba(255,255,255,.55) 0 2px, transparent 3px),
        radial-gradient(circle at 70% 30%, rgba(255,255,255,.45) 0 2px, transparent 3px),
        radial-gradient(circle at 40% 70%, rgba(255,255,255,.40) 0 2px, transparent 3px),
        radial-gradient(circle at 90% 80%, rgba(255,255,255,.50) 0 2px, transparent 3px);
      opacity:.25;
      mix-blend-mode: overlay;
      pointer-events:none;
      animation: twinkle 4.5s ease-in-out infinite alternate;
      transform: scale(1.2);
    }
    @keyframes twinkle{
      from { opacity:.16; filter: blur(.2px); }
      to { opacity:.32; filter: blur(.6px); }
    }

    .wrap{ width:min(760px, 92vw); padding:18px; }
    .card{
      background: var(--card);
      border: 1px solid rgba(255,255,255,.55);
      border-radius: 28px;
      box-shadow: var(--shadow);
      backdrop-filter: blur(12px);
      overflow:hidden;
    }

    .top{
      padding: 22px 22px 10px;
      display:flex; align-items:center; justify-content:space-between; gap:14px;
    }
    .badge{
      display:inline-flex; align-items:center; gap:10px;
      padding:10px 14px;
      background: rgba(255,255,255,.55);
      border: 1px solid rgba(255,255,255,.6);
      border-radius: 999px;
      font-weight: 700;
      letter-spacing:.2px;
    }
    .badge span{
      display:inline-grid; place-items:center;
      width:28px; height:28px; border-radius:999px;
      background: rgba(255,77,109,.10);
      border: 1px solid rgba(255,77,109,.18);
    }
    .tiny{ font-size:13px; opacity:.75; text-align:right; line-height:1.25; }

    .content{ padding: 10px 22px 22px; display:grid; gap: 16px; }
    h1{ margin:0; font-size: clamp(28px, 3.7vw, 40px); line-height:1.1; }
    .sub{ margin:0; font-size: 16px; opacity:.85; }

    .panel{
      background: var(--card2);
      border: 1px solid rgba(255,255,255,.45);
      border-radius: 22px;
      padding: 18px;
      display:grid;
      gap: 10px;
    }

    .envelope{
      width: 100%;
      max-width: 540px;
      margin: 6px auto 0;
      border-radius: 22px;
      background: rgba(255,255,255,.58);
      border: 1px solid rgba(255,255,255,.65);
      box-shadow: 0 12px 30px rgba(0,0,0,.10);
      overflow:hidden;
      padding: 18px;
      position: relative;
    }

    .seal{
      width: 62px; height: 62px;
      border-radius: 999px;
      background: radial-gradient(circle at 30% 30%, #fff, rgba(255,77,109,.22)),
                  linear-gradient(135deg, rgba(255,77,109,.75), rgba(108,99,255,.50));
      display:grid; place-items:center;
      border: 1px solid rgba(255,255,255,.7);
      box-shadow: 0 10px 18px rgba(0,0,0,.12);
      margin: 0 auto 10px;
      transform: rotate(-6deg);
    }

    .openBtn{
      margin-top: 10px;
      border: 0;
      border-radius: 999px;
      padding: 12px 16px;
      font-weight: 800;
      cursor:pointer;
      background: linear-gradient(135deg, rgba(255,77,109,1), rgba(108,99,255,1));
      color:white;
      box-shadow: 0 16px 30px rgba(255,77,109,.20);
      transition: transform .15s ease, filter .15s ease;
    }
    .openBtn:hover{ transform: translateY(-1px); filter: brightness(1.03); }
    .openBtn:active{ transform: translateY(1px); }

    .closed, .letter { text-align:center; }
    .letter{ display:none; animation: pop .35s ease both; }
    @keyframes pop{ from{ transform: translateY(10px) scale(.98); opacity:0; } to{ transform: translateY(0) scale(1); opacity:1; } }

    .type{
      font-size: 17px;
      line-height: 1.6;
      min-height: 104px;
      white-space: pre-wrap;
      text-align:left;
      padding: 0 6px;
    }

    /* Buttons row becomes the ONLY playground for the "No" button */
    .row{
      display:flex; gap: 12px; flex-wrap:wrap; justify-content:center;
      margin-top: 10px;
      position: relative;
      min-height: 56px; /* ensures there's always room for absolute positioning */
    }

    .btn{
      border: 0;
      border-radius: 999px;
      padding: 12px 16px;
      font-size: 16px;
      cursor:pointer;
      font-weight: 800;
      transition: transform .12s ease;
      user-select:none;
      touch-action: manipulation;
      position: relative;
      z-index: 1;
    }
    .btn:active{ transform: translateY(1px) scale(.99); }

    #yes{
      background: linear-gradient(135deg, rgba(255,77,109,1), rgba(255,140,170,1));
      color:white;
      box-shadow: 0 16px 30px rgba(255,77,109,.20);
    }
    #no{
      background: rgba(255,255,255,.55);
      color: rgba(0,0,0,.72);
      border: 1px solid rgba(0,0,0,.08);

      /* Important: "No" will be moved inside the buttons row */
      position: absolute;
      z-index: 2;
    }

    .status{ text-align:center; font-weight: 700; opacity: .85; margin-top: 10px; }

    .dateBox{ display:none; margin-top: 12px; gap: 10px; }
    .dateGrid{ display:grid; grid-template-columns: repeat(3, minmax(0,1fr)); gap: 10px; }
    @media (max-width: 560px){ .dateGrid{ grid-template-columns: 1fr; } .tiny{ display:none; } }

    .choice{
      background: rgba(255,255,255,.55);
      border: 1px solid rgba(255,255,255,.6);
      border-radius: 18px;
      padding: 14px;
      cursor:pointer;
      transition: transform .12s ease, filter .12s ease;
      text-align:left;
    }
    .choice:hover{ transform: translateY(-1px); filter: brightness(1.02); }
    .choice b{ display:block; margin-bottom: 6px; }
    .choice small{ opacity:.8; }

    .footer{
      padding: 14px 22px 20px;
      display:flex; justify-content:space-between; align-items:center; gap:12px;
      border-top: 1px solid rgba(255,255,255,.55);
      opacity: .78;
      font-size: 12px;
    }

    .confetti{ position:fixed; inset:0; pointer-events:none; overflow:hidden; }
    .piece{
      position:absolute;
      opacity:.95;
      animation: fall linear forwards;
      filter: drop-shadow(0 6px 10px rgba(0,0,0,.10));
      will-change: transform, opacity;
    }
    @keyframes fall{ to { transform: translateY(115vh) rotate(360deg); opacity: 0; } }
  </style>
</head>

<body>
  <div class="sparkles"></div>
  <div class="confetti" id="confetti"></div>

  <div class="wrap">
    <section class="card">
      <div class="top">
        <div class="badge"><span>üíó</span> For <span id="nameChip">you</span></div>
        <div class="tiny" id="dateText"></div>
      </div>

      <div class="content">
        <div>
          <h1>Hi Hi,</h1>
          <p class="sub">I made this because texting it felt too boring.</p>
        </div>

        <div class="envelope" id="envelope">
          <div class="closed" id="closed">
            <div class="seal"><b>‚úâÔ∏è</b></div>
            <div style="font-weight:800; font-size:18px;">Open when ready</div>
            <div style="opacity:.8; margin-top:4px;">(yes, it actually opens)</div>
            <button class="openBtn" id="openBtn" type="button">Open</button>
          </div>

          <div class="letter" id="letter">
            <div style="font-weight:900; font-size:18px; margin-bottom:8px; text-align:center;">
              Hey <span id="name">there</span>,
            </div>

            <div class="type" id="type"></div>

            <div class="row" id="buttons" style="display:none;">
              <button class="btn" id="yes" type="button">Yes</button>
              <button class="btn" id="no" type="button">No</button>
            </div>

            <div class="status" id="status"></div>

            <div class="dateBox" id="dateBox">
              <div style="text-align:center; font-weight:800;">Cool. Pick a vibe:</div>
              <div class="dateGrid">
                <div class="choice" data-choice="Call">
                  <b>üìû A proper call/date night</b>
                  <small>We plan a time, no distractions.</small>
                </div>
                <div class="choice" data-choice="Movie">
                  <b>üé¨ Watch something together</b>
                  <small>Same time, same movie.</small>
                </div>
                <div class="choice" data-choice="Games">
                  <b>üéÆ Games</b>
                  <small>Co-op, trash talk permitted.</small>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="panel">
          <div style="font-weight:800;">Note:</div>
          <div style="opacity:.85">
            Is this proper enough for you?
          </div>
        </div>
      </div>

      <div class="footer">
        <div>Made by your handsome and amazing boyfriend.</div>
        <div id="sig"></div>
      </div>
    </section>
  </div>

  <script>
    // ‚úÖ Customize these:
    const girlfriendName = "Tinja";
    const yourName = "Tobi";
    const valentineDate = "February 14";
    const introLines = [
      "This could‚Äôve been a normal message.",
      "But that felt a little boring.",
      "",
      "No big speech.",
      "So what's up?",
      "Do you want to be my Valentine?"
    ];

    // Optional WhatsApp jump after picking an option:
    const whatsappNumber = ""; // e.g. "4915112345678" (leave empty to disable)

    // --- UI ---
    document.getElementById("dateText").textContent = `Valentine‚Äôs Day: ${valentineDate}`;
    document.getElementById("name").textContent = girlfriendName;
    document.getElementById("nameChip").textContent = girlfriendName;
    document.getElementById("sig").textContent = `‚Äî ${yourName}`;

    const openBtn = document.getElementById("openBtn");
    const closed = document.getElementById("closed");
    const letter = document.getElementById("letter");
    const typeEl = document.getElementById("type");
    const buttons = document.getElementById("buttons");
    const status = document.getElementById("status");
    const noBtn = document.getElementById("no");
    const yesBtn = document.getElementById("yes");
    const dateBox = document.getElementById("dateBox");
    const confetti = document.getElementById("confetti");

    // Prevent double-open / double-typewriter bugs
    let opened = false;
    let typing = false;

    // Confetti cap so it can't lag
    const CONFETTI_CAP = 140;

    function confettiRain(count = 40){
      const emojis = ["üíó","üíñ","üíò","‚ù§Ô∏è","‚ú®"];
      for(let i=0;i<count;i++){
        if(confetti.childElementCount > CONFETTI_CAP) break;

        const el = document.createElement("div");
        el.className = "piece";
        el.textContent = emojis[Math.floor(Math.random()*emojis.length)];

        el.style.left = (Math.random()*100) + "vw";
        el.style.top = (-10 - Math.random()*20) + "vh";
        el.style.animationDuration = (2.6 + Math.random()*2.8) + "s";
        el.style.fontSize = (16 + Math.random()*14) + "px";

        confetti.appendChild(el);
        setTimeout(()=> el.remove(), 6500);
      }
    }

    function typeLines(lines, speed=22){
      if(typing) return;
      typing = true;

      typeEl.textContent = "";
      let i = 0, j = 0;

      function tick(){
        if(i >= lines.length){
          typing = false;
          buttons.style.display = "flex";
          // place "No" once buttons are visible
          setTimeout(() => moveNoButtonSafely(), 50);
          return;
        }
        const line = lines[i];

        if(j <= line.length){
          const prefix = lines.slice(0,i).join("\n");
          typeEl.textContent = prefix + (i ? "\n" : "") + line.slice(0,j);
          j++;
          setTimeout(tick, speed);
        } else {
          i++; j = 0;
          setTimeout(tick, 220);
        }
      }
      tick();
    }

    openBtn.addEventListener("click", () => {
      if(opened) return;
      opened = true;
      closed.style.display = "none";
      letter.style.display = "block";
      confettiRain(20);
      typeLines(introLines);
    });

    let noCount = 0;
    const noMessages = [
      "Alright. Fair.",
      "Still fair.",
      "Okay but I had to try.",
      "I respect the honesty.",
      "This button is doing its own thing now.",
      "The button is panicking a little.",
      "Okay, noted.",
      "Message received.",
      "I respect that.",
      "I‚Äôm not proud of this feature."
    ];

    // ‚úÖ FIX: Keep "No" inside the BUTTON ROW (not the whole envelope)
    function moveNoButtonSafely(){
      const rowRect = buttons.getBoundingClientRect();
      const btnRect = noBtn.getBoundingClientRect();

      const pad = 6;
      const maxX = Math.max(0, rowRect.width - btnRect.width - pad*2);
      const maxY = Math.max(0, rowRect.height - btnRect.height - pad*2);

      const x = pad + Math.random() * maxX;
      const y = pad + Math.random() * maxY;

      // Position relative to the buttons row
      buttons.style.position = "relative";
      noBtn.style.left = x + "px";
      noBtn.style.top = y + "px";
      noBtn.style.transform = "none";
      noBtn.style.transition = "left .14s ease, top .14s ease";
      noBtn.style.zIndex = "2";
    }

    yesBtn.addEventListener("click", () => {
      status.textContent = "Nice. That made my day.";
      confettiRain(70);
      dateBox.style.display = "grid";
      dateBox.style.gap = "10px";
      noBtn.style.opacity = 0.7;
    });

    noBtn.addEventListener("click", () => {
      status.textContent = noMessages[Math.min(noCount, noMessages.length - 1)];
      noCount++;
      moveNoButtonSafely();
    });

    // Re-clamp on window resize so it never ends up off-row
    window.addEventListener("resize", () => {
      if(buttons.style.display !== "none") moveNoButtonSafely();
    });

    document.querySelectorAll(".choice").forEach(el => {
      el.addEventListener("click", () => {
        const choice = el.getAttribute("data-choice");
        confettiRain(55);
        status.textContent = `Perfect. Let‚Äôs do: ${choice}.`;

        if(whatsappNumber){
          const msg = encodeURIComponent(`I clicked YES ‚Äî let's do: ${choice} for Valentine's üíñ`);
          window.location.href = `https://wa.me/${whatsappNumber}?text=${msg}`;
        }
      });
    });
  </script>
</body>
</html>
